#N canvas 435 -23 1038 870 10;
#X obj -28 327 expr log(1 + $f1 * (exp(1) - 1));
#X obj 26 397 + 128;
#X obj 26 373 r \$0-address;
#X text 163 -127 time is in ms;
#X obj -28 -70 t a b;
#X obj -1 -45 s \$0-all_stop;
#X msg -4 259 stop;
#X obj -4 237 r \$0-all_stop;
#X text 20 -139 type ms hue saturation;
#X obj -28 -117 inlet;
#X obj 34 264 r \$0-grain;
#X obj -28 453 pack f 0 128 1;
#N canvas 477 208 647 776 remap_and_store 0;
#X obj 30 -18 inlet;
#X obj 32 584 outlet;
#X obj 69 413 * 127;
#X obj 69 436 i;
#X obj 69 463 mod 128;
#X obj 30 191 t a a;
#X msg 73 224 \$3 \$4 \$5;
#X text 78 191 address command h s v;
#X obj 73 251 unpack f f f;
#X obj 73 317 s \$0-cur_h;
#X obj 107 295 s \$0-cur_s;
#X obj 142 273 s \$0-cur_v;
#X obj 124 438 * 127;
#X obj 124 461 i;
#X obj 122 64 xnor_clamp 0 1;
#X obj 163 438 * 127;
#X obj 163 461 i;
#X obj 98 102 xnor_clamp 0 1;
#X obj 32 532 pack f f f f f;
#X obj 30 364 unpack f f f f f;
#X text 169 360 remap 0..1 to 0..127;
#X text 81 -17 store pre mapping but clamp first;
#X obj 30 150 pack f f f f f;
#X obj 30 32 unpack f f f f f;
#X connect 0 0 23 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 18 2;
#X connect 5 0 19 0;
#X connect 5 1 6 0;
#X connect 6 0 8 0;
#X connect 8 0 9 0;
#X connect 8 1 10 0;
#X connect 8 2 11 0;
#X connect 12 0 13 0;
#X connect 13 0 18 3;
#X connect 14 0 22 4;
#X connect 15 0 16 0;
#X connect 16 0 18 4;
#X connect 17 0 22 3;
#X connect 18 0 1 0;
#X connect 19 0 18 0;
#X connect 19 1 18 1;
#X connect 19 2 2 0;
#X connect 19 3 12 0;
#X connect 19 4 15 0;
#X connect 22 0 5 0;
#X connect 23 0 22 0;
#X connect 23 1 22 1;
#X connect 23 2 22 2;
#X connect 23 3 17 0;
#X connect 23 4 14 0;
#X restore -28 530 pd remap_and_store;
#X msg -28 482 \$3 0 \$2 \$4 \$1;
#X text 163 -140 h \, s \, v is given in range 0..1;
#X obj -28 97 unpack f f f f;
#X obj -28 186 pack f f;
#X msg 34 -109 black 100 0.3 0.7 0.2;
#X msg -28 213 0 \, \$2 \$1;
#N canvas 374 24 1273 958 from_current 0;
#X msg 205 486 stop;
#X obj 205 464 r \$0-all_stop;
#X obj 227 513 r \$0-grain;
#X obj 98 419 f 1;
#X obj 393 89 t a b;
#X obj 393 132 unpack f f f f;
#X obj 182 403 pack f f;
#X msg 182 431 \$2 \$1;
#X msg 444 476 stop;
#X obj 444 454 r \$0-all_stop;
#X obj 466 506 r \$0-grain;
#X obj 337 409 f 1;
#X obj 421 393 pack f f;
#X msg 421 421 \$2 \$1;
#X obj 113 396 r \$0-cur_h;
#X obj 352 386 r \$0-cur_s;
#X msg 675 476 stop;
#X obj 675 454 r \$0-all_stop;
#X obj 697 506 r \$0-grain;
#X obj 568 409 f 1;
#X obj 652 393 pack f f;
#X msg 652 421 \$2 \$1;
#X obj 583 386 r \$0-cur_v;
#X obj 393 266 t f f f;
#X obj 393 46 inlet;
#X text 799 449 should value be log?;
#N canvas 483 254 647 776 remap_and_store 0;
#X obj 30 -18 inlet;
#X obj 32 584 outlet;
#X obj 69 413 * 127;
#X obj 69 436 i;
#X obj 69 463 mod 128;
#X obj 30 191 t a a;
#X msg 73 224 \$3 \$4 \$5;
#X text 78 191 address command h s v;
#X obj 73 251 unpack f f f;
#X obj 73 317 s \$0-cur_h;
#X obj 107 295 s \$0-cur_s;
#X obj 142 273 s \$0-cur_v;
#X obj 124 438 * 127;
#X obj 124 461 i;
#X obj 122 64 xnor_clamp 0 1;
#X obj 163 438 * 127;
#X obj 163 461 i;
#X obj 98 102 xnor_clamp 0 1;
#X obj 32 532 pack f f f f f;
#X obj 30 364 unpack f f f f f;
#X text 169 360 remap 0..1 to 0..127;
#X text 81 -17 store pre mapping but clamp first;
#X obj 30 150 pack f f f f f;
#X obj 30 32 unpack f f f f f;
#X connect 0 0 23 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 18 2;
#X connect 5 0 19 0;
#X connect 5 1 6 0;
#X connect 6 0 8 0;
#X connect 8 0 9 0;
#X connect 8 1 10 0;
#X connect 8 2 11 0;
#X connect 12 0 13 0;
#X connect 13 0 18 3;
#X connect 14 0 22 4;
#X connect 15 0 16 0;
#X connect 16 0 18 4;
#X connect 17 0 22 3;
#X connect 18 0 1 0;
#X connect 19 0 18 0;
#X connect 19 1 18 1;
#X connect 19 2 2 0;
#X connect 19 3 12 0;
#X connect 19 4 15 0;
#X connect 22 0 5 0;
#X connect 23 0 22 0;
#X connect 23 1 22 1;
#X connect 23 2 22 2;
#X connect 23 3 17 0;
#X connect 23 4 14 0;
#X restore 474 858 pd remap_and_store;
#X obj 609 697 + 128;
#X obj 609 673 r \$0-address;
#X msg 474 810 \$4 0 \$1 \$2 \$3;
#X obj 474 781 pack f f f 128;
#X obj 474 894 outlet;
#X obj 227 380 r \$0-target_h;
#X obj 466 370 r \$0-target_s;
#X obj 697 370 r \$0-target_v;
#X obj 474 156 s \$0-target_v;
#X obj 447 177 s \$0-target_s;
#X obj 420 201 s \$0-target_h;
#X obj 182 542 line 0 5;
#X obj 421 532 line 0 5;
#X obj 652 532 line 0 5;
#X connect 0 0 38 0;
#X connect 1 0 0 0;
#X connect 2 0 38 2;
#X connect 3 0 38 0;
#X connect 4 0 5 0;
#X connect 4 1 3 0;
#X connect 4 1 11 0;
#X connect 4 1 19 0;
#X connect 5 0 23 0;
#X connect 5 1 37 0;
#X connect 5 2 36 0;
#X connect 5 3 35 0;
#X connect 6 0 7 0;
#X connect 7 0 38 0;
#X connect 8 0 39 0;
#X connect 9 0 8 0;
#X connect 10 0 39 2;
#X connect 11 0 39 0;
#X connect 12 0 13 0;
#X connect 13 0 39 0;
#X connect 14 0 3 1;
#X connect 15 0 11 1;
#X connect 16 0 40 0;
#X connect 17 0 16 0;
#X connect 18 0 40 2;
#X connect 19 0 40 0;
#X connect 20 0 21 0;
#X connect 21 0 40 0;
#X connect 22 0 19 1;
#X connect 23 0 6 0;
#X connect 23 1 12 0;
#X connect 23 2 20 0;
#X connect 24 0 4 0;
#X connect 26 0 31 0;
#X connect 27 0 30 3;
#X connect 28 0 27 0;
#X connect 29 0 26 0;
#X connect 30 0 29 0;
#X connect 32 0 6 1;
#X connect 33 0 12 1;
#X connect 34 0 20 1;
#X connect 38 0 30 0;
#X connect 39 0 30 1;
#X connect 40 0 30 2;
#X restore 221 105 pd from_current;
#X obj -28 562 s \$0-command_out;
#X obj 221 129 s \$0-command_out;
#X obj -25 588 r \$0-command_out;
#X obj -27 618 outlet;
#X obj 539 94 r \$0-cur_h;
#X floatatom 544 138 5 0 0 0 - - -;
#X floatatom 613 137 5 0 0 0 - - -;
#X floatatom 680 137 5 0 0 0 - - -;
#X obj 608 93 r \$0-cur_s;
#X obj 675 93 r \$0-cur_v;
#X obj -1 157 s \$0-target_h;
#X obj 26 136 s \$0-target_s;
#X obj 53 424 r \$0-target_s;
#X msg 176 -108 current 100 0 0.7 0.295;
#X obj 78 65 s \$0-address;
#X obj 513 -85 loadbang;
#X obj 513 -52 i \$1;
#X obj 513 -23 s \$0-address;
#X text 513 -114 set the address;
#X obj -1 348 r \$0-target_h;
#X obj -28 9 route black current address grain;
#X obj 123 39 s \$0-grain;
#X obj -28 294 line 0 5;
#X connect 0 0 11 0;
#X connect 1 0 11 2;
#X connect 2 0 1 0;
#X connect 4 0 40 0;
#X connect 4 1 5 0;
#X connect 6 0 42 0;
#X connect 7 0 6 0;
#X connect 9 0 4 0;
#X connect 10 0 42 2;
#X connect 11 0 13 0;
#X connect 12 0 20 0;
#X connect 13 0 12 0;
#X connect 15 0 16 0;
#X connect 15 1 30 0;
#X connect 15 2 31 0;
#X connect 15 3 16 1;
#X connect 16 0 18 0;
#X connect 17 0 4 0;
#X connect 18 0 42 0;
#X connect 19 0 21 0;
#X connect 22 0 23 0;
#X connect 24 0 25 0;
#X connect 28 0 26 0;
#X connect 29 0 27 0;
#X connect 32 0 11 3;
#X connect 33 0 4 0;
#X connect 35 0 36 0;
#X connect 36 0 37 0;
#X connect 39 0 11 1;
#X connect 40 0 15 0;
#X connect 40 1 19 0;
#X connect 40 2 34 0;
#X connect 40 3 41 0;
#X connect 42 0 0 0;
